<!DOCTYPE html>
<html>

<head>
<style>
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
  padding-left: 5px;
  padding-right: 5px;
  text-align: center;
}
img {
  image-rendering: pixelated; /* Nearest-neighbor scaling */
}

</style>

<meta name="description" content="Tibiantis Notes - Tibia 7.4 Annihilator Quest">
  <meta name="keywords" content="Tibiantis, Tibia, 7.4, anni, annihilator">
<meta title ="Tibiantis Notes - Annihilator quest">
<meta name="author" content="Tarsal">

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

</head>


<body>
<a href="https://tibiantis-notes.github.io/">Home</a>
<h1>Tibia 7.4/ Tibiantis notes</h1>
<p><i>by Tarsal.</i></p>
<hr>
  

<div style="width: 900px">
<h1>Annihilator Quest</h1>

<h2>Introduction</h2>

This page discusses the Annihilator quest. Due to high damages and combos it is often a matter of luck if you can survive, even if you have enough skill to UH accurately. Damage probrabilities have been calculated and inform chance of death in different scenarios, the effect of items, and to allow comparison of different strategies.<br><br>

<h2>Damage Analysis - set up</h2>
The quest must be completed by 4 Lv100+ players. There are 6 demons, and each of the four players can be hit by up to 3 energy beams.<br><br>

Demons cast fireballs dealing 110-200 fire damage with a chance of 1/3, and energy damage beams of damage 300-420 with a chance of 1/10. Due to CIP code, the 5 demons that are not in melee range will roll the chance to cast every second and the remaining demon every two seconds.<br><br>

The average damage on turn 1 and 2 is therefore 310 + 108 = 418, and 258 + 72 = 330, for an overall average of 374 damage.<br><br>

- Chance of no hit on a single second is 8.53%. This is not shown on the chart.
- Fire damage makes up a 50% or more of the total damage, for most damage values. This is due to it being more likely that two demons cast fire balls (1/9) than 1 energy beam (1/10).
- Demons cast mana drain at an average of 70 and frequency 8 and an average of 12 mana per second per player. This mostly affects mana shield users.
- A lv 100 knight will very rarely be hit in one shot however if they are blocking this is much more likely. Knights are also more succeptible to 2 concequitive high damage seconds but these are still quite rare.
- Mages casting UE take 800 mana,to cast and 750 mana from demons. 1000-1250 average damage with UE for Lv100-150 and you'll take 2 or three for 400-700 mana with SSA. (to be continued).

<h2>Damage Analysis - result</h2>

<canvas id="myChart" style="width:100%;max-width:900px"></canvas>

<h2>Table: Annihilator damage statistics</h2>
<table>
<tr><th>Damage<br>(X)</th><th>X Chance<br>(X to X+9)</th><th>% Chance<br>(X or higher)</th><th>1/ Chance</th></tr>
<tr><td>0</td><td>8.53</td><td>100</td><td>1.0</td></tr>
<tr><td>50</td><td>0.00</td><td>91.5</td><td>1.1</td></tr>
<tr><td>100</td><td>0.00</td><td>91.5</td><td>1.1</td></tr>
<tr><td>150</td><td>2.55</td><td>81.3</td><td>1.2</td></tr>
<tr><td>200</td><td>0.00</td><td>68.5</td><td>1.5</td></tr>
<tr><td>250</td><td>1.110</td><td>67.1</td><td>1.5</td></tr>
<tr><td>300</td><td>2.860</td><td>58.4</td><td>1.7</td></tr>
<tr><td>350</td><td>1.650</td><td>46.1</td><td>2.2</td></tr>
<tr><td>400</td><td>0.769</td><td>40.1</td><td>2.5</td></tr>
<tr><td>450</td><td>1.460</td><td>34.8</td><td>2.9</td></tr>
<tr><td>500</td><td>1.430</td><td>27.1</td><td>3.7</td></tr>
<tr><td>550</td><td>0.789</td><td>21.4</td><td>4.7</td></tr>
<tr><td>600</td><td>0.684</td><td>17.9</td><td>5.6</td></tr>
<tr><td>650</td><td>0.794</td><td>14.2</td><td>7.0</td></tr>
<tr><td>700</td><td>0.597</td><td>10.5</td><td>9.5</td></tr>
<tr><td>750</td><td>0.369</td><td>8.07</td><td>12</td></tr>
<tr><td>800</td><td>0.343</td><td>6.32</td><td>16</td></tr>
<tr><td>850</td><td>0.314</td><td>4.61</td><td>22</td></tr>
<tr><td>900</td><td>0.202</td><td>3.26</td><td>31</td></tr>
<tr><td>950</td><td>0.138</td><td>2.41</td><td>42</td></tr>
<tr><td>1000</td><td>0.121</td><td>1.76</td><td>57</td></tr>
<tr><td>1050</td><td>0.0898</td><td>1.21</td><td>83</td></tr>
<tr><td>1100</td><td>0.0560</td><td>0.830</td><td>120</td></tr>
<tr><td>1150</td><td>0.0405</td><td>0.588</td><td>170</td></tr>
<tr><td>1200</td><td>0.0320</td><td>0.402</td><td>250</td></tr>
<tr><td>1250</td><td>0.0215</td><td>0.263</td><td>380</td></tr>
<tr><td>1300</td><td>0.0134</td><td>0.174</td><td>580</td></tr>
<tr><td>1350</td><td>0.0096</td><td>0.115</td><td>870</td></tr>
<tr><td>1400</td><td>0.0067</td><td>0.073</td><td>1400</td></tr>
<tr><td>1450</td><td>0.0041</td><td>0.045</td><td>2200</td></tr>
<tr><td>1500</td><td>0.0025</td><td>0.028</td><td>3600</td></tr>
<tr><td>1550</td><td>0.0017</td><td>0.017</td><td>5800</td></tr>
<tr><td>1600</td><td>0.0011</td><td>0.010</td><td>9700</td></tr>
</table>

<p id="test1"></p>
<p id="test2"></p>

</div>


<script>

function calculate_distrib() {


document.getElementById('test1').innerHTML = "Start of code<br>";

let fireball_damage = new Array(200).fill(0);
let fireball_damage_intermediate = new Array(1300).fill(0);
let fireball_damage_total = new Array(1300).fill(0);
let fireball_damage_total_b = new Array(1300).fill(0);
let energy_damage = new Array(420).fill(0);
let energy_damage_intermediate = new Array(1300).fill(0);
let energy_damage_total = new Array(1300).fill(0);
let energy_damage_total_b = new Array(1300).fill(0);
let damage_total_a = new Array(2600).fill(0); //big hit
let damage_total_b = new Array(2600).fill(0); //small hit
let damage_total = new Array(3100).fill(0); //average hit
let damage_total_tens = new Array(310).fill(0); //average hit
let damage_total_above = new Array(310).fill(0); //average hit
let physical_damage = new Array(500).fill(0); //physical hit
let blocker_total_a = new Array(3100).fill(0); //physical hit + spells big hit

let i=0; let j=0; let k=0;
let test2_text="";

for (i=0; i<90; i++) {
  fireball_damage[i+110] = (1/90)*(1/3);
  }//end of fireball for
fireball_damage[0] = 2/3;

for (i=0; i<120; i++) {
  energy_damage[i+300] = (1/120)*(1/10);
  }//end of fireball for
energy_damage[0] = 9/10;

for (let i = 0; i < fireball_damage.length; i++) { //apply first fireball
    fireball_damage_intermediate[i] = fireball_damage[i];
}

for (let i = 0; i < energy_damage.length; i++) { // apply first energy beam
    energy_damage_intermediate[i] = energy_damage[i];
}

//merge fire ball and total. Then cycle 5 times.
for (k=0; k<5; k++) { // loop through number of demons (5.5)
  for (i=0; i<1100; i++) { // loop through running total
    for (j=0; j<200; j++) { // loop through fireball
      fireball_damage_total[i+j] += fireball_damage_intermediate[i] * fireball_damage[j];
      } //end of j loop
    } // end of i loop
  fireball_damage_intermediate = Array.from(fireball_damage_total);
  fireball_damage_total.fill(0);
  
  if(k==3){ // k= 3 -> 5th fb.
    fireball_damage_total_b = Array.from(fireball_damage_intermediate);
    } // end of if

  if(k==4){ // k= 4 -> 6th fb.
    fireball_damage_total = Array.from(fireball_damage_intermediate);
    } // end of if
  } //end of loop fireball

//merge energy veam and total. Then cycle 5 times.
for (k=0; k<2; k++) { // loop through number of demons (5.5)
  for (i=0; i<900; i++) { // loop through running total
    for (j=0; j<420; j++) { // loop through energy
      energy_damage_total[i+j] += energy_damage_intermediate[i] * energy_damage[j];
      } //end of j loop
    } // end of i loop
  energy_damage_intermediate = Array.from(energy_damage_total);
  energy_damage_total.fill(0);
  
  if(k==0){ // k= 3 -> 5th fb.
    energy_damage_total_b = Array.from(energy_damage_intermediate);
    } // end of if

  if(k==1){ // k= 4 -> 6th fb.
    energy_damage_total = Array.from(energy_damage_intermediate);
    } // end of if
  } //end of loop energy

// Fire+energy a
for (i=0; i<1300; i++) {
  for (j=0; j<1300; j++) {
    damage_total_a[i+j] += fireball_damage_total[i] * energy_damage_total[j]; // bit hit
    damage_total_b[i+j] += fireball_damage_total_b[i] * energy_damage_total_b[j]; // small hit
    } // end of i
  } // end of j


// Magic + melee - big hit
for (i=0; i<2600; i++) {
  for (j=0; j<500; j++) {
    blocker_total_a[i+j] += damage_total_a[i] * physical_damage[j]; // bit hit
    } // end of i
  } // end of j

document.getElementById('test2').innerHTML = 
"i got to here2<br>";

for (i=0; i<3100; i++) { // combine big and small hits
damage_total[i] = (blocker_total[i] + damage_total_b[i])/2;
} // end of for (alwas damage total a +)

for (i=0; i<3100; i++) { // shrink to 10s
damage_total_tens[Math.floor(i/10)] += damage_total[i];
} // end of for

document.getElementById('test2').innerHTML = 
"i got to here3<br>";

damage_total_above[309] = damage_total_tens[309];
for (i=308; i>=0; i--) { // accumulate
damage_total_above[i] =
  damage_total_above[i+1] + damage_total_tens[i];
} // end of for

document.getElementById('test2').innerHTML = 
"end of code<br>";


for (i=0; i<310; i++) { // print
   test2_text += 10*i + "\t" + damage_total_tens[i] + "\t" + damage_total_above[i] + "<br>";
    } // end of for print
    document.getElementById('test2').innerHTML += test2_text;


} // end of calc distrib

calculate_distrib(); /*commented out as damage is entered as const*/

const xValues = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000, 1010, 1020, 1030, 1040, 1050, 1060, 1070, 1080, 1090, 1100, 1110, 1120, 1130, 1140, 1150, 1160, 1170, 1180, 1190, 1200, 1210, 1220, 1230, 1240, 1250, 1260, 1270, 1280, 1290, 1300, 1310, 1320, 1330, 1340, 1350, 1360, 1370, 1380, 1390, 1400, 1410, 1420, 1430, 1440, 1450, 1460, 1470, 1480, 1490, 1500, 1510, 1520, 1530, 1540, 1550, 1560, 1570, 1580, 1590, 1600];
const yValues = [8.533, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 2.548, 2.548, 2.548, 2.548, 2.548, 2.548, 2.548, 2.548, 2.548, 0.000, 0.000, 0.172, 0.485, 0.798, 1.110, 1.423, 1.736, 2.049, 2.361, 2.862, 2.830, 2.518, 2.209, 1.919, 1.648, 1.398, 1.168, 0.957, 0.767, 0.769, 0.964, 1.003, 1.197, 1.351, 1.465, 1.539, 1.576, 1.575, 1.537, 1.431, 1.277, 1.144, 1.011, 0.885, 0.789, 0.721, 0.679, 0.661, 0.664, 0.684, 0.700, 0.732, 0.770, 0.792, 0.794, 0.779, 0.749, 0.707, 0.655, 0.597, 0.541, 0.486, 0.435, 0.396, 0.369, 0.353, 0.344, 0.340, 0.341, 0.343, 0.346, 0.347, 0.342, 0.331, 0.314, 0.294, 0.271, 0.248, 0.224, 0.202, 0.183, 0.166, 0.154, 0.144, 0.138, 0.133, 0.130, 0.127, 0.124, 0.121, 0.116, 0.111, 0.105, 0.097, 0.090, 0.082, 0.075, 0.068, 0.061, 0.056, 0.051, 0.048, 0.045, 0.042, 0.040, 0.039, 0.037, 0.036, 0.034, 0.032, 0.030, 0.028, 0.026, 0.024, 0.022, 0.020, 0.018, 0.016, 0.015, 0.013, 0.012, 0.012, 0.011, 0.010, 0.010, 0.009, 0.008, 0.008, 0.007, 0.007, 0.006, 0.006, 0.005, 0.005, 0.004, 0.004, 0.003, 0.003, 0.003, 0.002, 0.002, 0.002, 0.002, 0.002, 0.002, 0.002, 0.001, 0.001, 0.001, 0.001];

/*const barColors = ["red", "green","blue","orange","brown"];*/

const barColors ="red";
//Chart.defaults.backgroundColor = rgb(54, 162, 235);


new Chart("myChart", {
  type: "bar",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    legend: { display: false },
    title: {
      display: true,
      text: "Annihilator Damage Distribution\nShooter"
    },
    scales: {
      xAxes: [{
        ticks: {
          min: 0,
          max: 1500,
          stepSize:50
        },
        scaleLabel: {
          display: true,
          labelString: "Damage"
        }
      }],
      yAxes: [{
        ticks: {
          min: 0,
          max: 4,
          stepSize: 0.5
        },
        scaleLabel: {
          display: true,
          labelString: "Chance (%) of damage occuring each second\n(e.g. 2.5% chance for damage between 120-129)"
        }
      }]
    }
  }
});


</script>

</body>
</html>
